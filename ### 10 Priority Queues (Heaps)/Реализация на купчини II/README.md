# Внедряване на купчини II

В предишната лекция обсъдихме как да представим структурата на данните HEAP с помощта на едномерен масив или вектор. Обхванахме операцията за вмъкване, операцията за пик и операцията за пул. В тази лекция ще се фокусираме върху алгоритъма за Heap Sort и функцията fixed-down.

## Преглед на операциите с купчина

Когато премахнем даден елемент от купчината (например коренния възел), ние го заместваме с последния елемент в едномерния масив. Например, ако премахнем основния възел и го заменим с последния елемент (напр. 5), свойствата на купчината може да бъдат нарушени, тъй като 5 не е най-големият елемент.

### Фиксирана функция надолу

За да възстановим свойствата на купчината, трябва да сравним родителския възел с неговите деца. Ние определяме максималното дете, което ще ни помогне да определим дали свойствата са нарушени. Например, ако сравним 5 (новия корен) с неговите деца (23 и 100), виждаме, че 100 е по-голямо от 23, така че разменяме 5 със 100.

1. **Идентифициране на по-голямото дете:**
 - Сравнете лявото и дясното дете, за да определите по-голямото дете.
 - Ако лявото дете е по-голямо от родителския възел, най-големият индекс става индексът на лявото дете.
 - Ако дясното дете е по-голямо от лявото дете, актуализираме най-големия индекс до индекса на дясното дете.

2. **Размяна и рекурсия:**
 - Ако индексът на родителския възел не е равен на най-големия индекс, разменете ги.
 - Извикайте рекурсивно функцията с фиксирано надолу върху засегнатото дете, докато всички свойства бъдат удовлетворени.

### Внедряване на сортиране в купчина

Операцията за сортиране на купчина е проста. За да сортираме купчината, извикваме операцията на пула толкова пъти, колкото е броят на елементите в купчината. Операцията на пула извлича максималния елемент, разменя го с последния възел и извиква функцията за фиксирано надолу, за да поддържа свойствата на купчината.
