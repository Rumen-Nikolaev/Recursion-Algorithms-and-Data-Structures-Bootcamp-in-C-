# Използване на Heap Data Structure за сортиране (Heapsort)

Heapsort е базиран на сравнение алгоритъм за сортиране, който използва структурата на данните на купчината. За първи път е конструиран от GwG Williams и е една от мотивите за разработване на купчини. Въпреки че heapsort не е толкова бърз, колкото добре внедреното бързо сортиране на повечето машини, той има някои значителни предимства, особено по отношение на времевата сложност.

## Основни характеристики

- **Времева сложност**:
 - **Най-добър случай**: O(n log n)
 - **Среден случай**: O(n log n)
 - **Най-лош случай**: O(n log n)

- **Пространствена сложност**: O(1) (сортиране на място)

- **Стабилност**: Heapsort **не е стабилен алгоритъм за сортиране**. Той не поддържа относителния ред на елементи с еднаква стойност.

## Общ преглед на Heapsort

Алгоритъмът за heapsort се състои от две основни фази:

1. **Изграждане на купчина**: Преобразувайте входния масив в максимална купчина. Това гарантира, че най-големият елемент е в основата на купчината.

2. **Сортиране на масива**:
 - Неколкократно премахване на най-големия елемент от купчината (основен възел), разменяйте го с последния елемент на купчината и намалете размера на купчината.
 - След всяко премахване изпълнете операцията heapify, за да поддържате свойството heap.

### Подробни стъпки

1. **Изградете максимална купчина**:
 - Вмъкнете всеки елемент в купчината, която отнема O(log n) за всяко вмъкване. За n елемента общата сложност за тази фаза е O(n).

2. **Сортирайте масива**:
 - За всяка итерация направете следното:
 - Разменете коренния възел (максималния елемент) с последния елемент от текущата купчина.
 - Намалете размера на купчината с едно.
 - Heapify коренния възел, за да възстановите свойствата на heap.
 - Тази операция отнема O(log n) за всеки от n елемента, което води до O(n log n) времева сложност за фазата на сортиране.

### Пример за Heapsort

Помислете за масива: „[92, 78, 23, 21, 12, 5, 2]“.

1. **Изградете максималната купчина**:
 - Получената максимална купчина ще има `92` в основата.

2. **Стъпки на сортиране**:
 - Разменете `92` с `2`, правейки масива `[2, 78, 23, 21, 12, 5, 92]`. Heapify ни дава `[78, 21, 23, 2, 12, 5]`.
 - Разменете „78“ с „5“, което води до „[5, 21, 23, 2, 12, 78]“. Heapify дава `[23, 21, 5, 2, 12]`.
 - Продължете този процес, докато масивът бъде напълно сортиран.

След всички итерации сортираният масив ще бъде „[92, 78, 23, 21, 12, 5, 2]“.

## Заключение

Heapsort е мощен алгоритъм за сортиране, който е ефективен и работи на място, което го прави подходящ за приложения, където използването на паметта е проблем. Важно е обаче да вземете предвид стабилността на сортирането въз основа на изискванията на вашето приложение.
